{
  "hash": "6e3285d6c1b8f42a95208f24919c4a4e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 2: Discussion Section - Answer Key\"\nsubtitle: \"Working with multiple vector types\"\nauthor: \"Alessandra Vidal Meza\"\ndate: last-modified\nexecute: \n  freeze: true \n  eval: true\n  message: false\n  warning: false\nformat:\n  html:\n    toc: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n## Read in Vector Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(here)\nlibrary(tidyverse)\nlibrary(stars)\nlibrary(sf)\nlibrary(tmap)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncol <- st_read(here::here(\"data\", \"week2-discussion\", \"Colombia\", \"Colombia.shp\"))\n\nroads <- st_read(here::here(\"data\", \"week2-discussion\", \"RDLINE_colombia\", \"RDLINE_colombia.shp\"))\n\naves <- readr::read_csv(here::here(\"data\", \"week2-discussion\", \"dataves.csv\")) %>%\n  dplyr::as_tibble() %>%\n  dplyr::rename(long = decimal_longitude) %>%\n  dplyr::mutate(lat = decimal_latitude) %>%\n  st_as_sf(coords = c(\"long\", \"lat\"), crs = 4326)\n```\n:::\n\n\n\n\n\n## Check Class and Geometry Type\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(col)\nclass(roads)\nclass(aves)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(st_geometry_type(col))\nunique(st_geometry_type(roads))\nunique(st_geometry_type(aves))\n```\n:::\n\n\n\n## Select Macro Region of Interest\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncol_andean <- col %>%\n  # Set categorical \"levels\" in attribute N1_MacroBi (subregions of Colombia)\n  dplyr::mutate(N1_MacroBi = as.factor(N1_MacroBi)) %>%\n  # Subset to Andean region of Colombia\n  dplyr::filter(N1_MacroBi == \"Andean\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(col_andean) +\n  tm_polygons() +\n  tm_layout(main.title = \"Andean Region of Colombia\",\n            main.title.size = 1)\n```\n\n::: {.cell-output-display}\n![](week2-discussion-answerKey_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n## Play with Coordinate Reference System \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the CRS of each spatial object\nst_crs(col)\nst_crs(roads)\nst_crs(aves)\n\n# Print units of each CRS \nst_crs(col)$units\nst_crs(roads)$units\nst_crs(aves)$units\n```\n:::\n\n\n\nThere are several ways to extract the longitude and latitude from the `geometry` column.\n\n### `purr` Approach\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naves_df_purrr <- aves %>%\n  # Extract lat & long from geometry column\n  mutate(lon = unlist(purrr::map(aves$geometry, 1)), # longitude = first component (x)\n         lat = unlist(purrr::map(aves$geometry, 2))) %>% # latitude = second component (y)\n  st_drop_geometry() # Remove geometry column now that it's redundant\n```\n:::\n\n\n\n### `st_coordinates` Approach\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naves_df_st_coords <- aves %>%\n  dplyr::mutate(lon = sf::st_coordinates(.)[,1],# Assign first matrix item to \"lon\"\n                lat = sf::st_coordinates(.)[,2]) %>% # Assign second matrix item to \"lat\"\n  st_drop_geometry() # Remove geometry column now that it's redundant\n```\n:::\n\n\n\nNext, convert to `sf` object again.\n\n### `st_as_sf` Approach\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naves_df_purrr <- aves %>%\n  st_as_sf(coords = c(\"lon\", \"lat\"), crs = 4326)\n```\n:::\n\n\n\n\n## Bring All Vector Data Types Together\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Boolen check if CRS match between 2 datasets\nst_crs(col) == st_crs(roads)\n\n# Transform bird data into same CRS as other Colombia data\naves <- st_transform(aves, crs = st_crs(col))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Simple plot with all 3 data layers\ntm_shape(col) +\n  tm_polygons() +\n  tm_shape(roads) +\n  tm_lines() +\n  tm_shape(aves) +\n  tm_dots() +\n  tm_layout(main.title = \"Colombia ecoregions, roads,\\nand bird observations\",\n            main.title.size = 1)\n```\n\n::: {.cell-output-display}\n![](week2-discussion-answerKey_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "week2-discussion-answerKey_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}